<?php
/**
 * @var \Bydn\VirtualMirror\Block\VirtualMirror $block
 */
?>
<?php if ($block->isVisible()) : ?>
    
    <div id="virtual-mirror-anchor" class="bydn-virtual-mirror">
        <button type="button" id="call-mirror-method" class="action secondary tocart">
            <span>Try on me</span>
        </button>
    </div>

    <!-- Pre-created modal -->
    <div id="virtual-mirror-modal" style="display: none;">
        <div class="virtual-mirror-content">
            <div class="loading-message">
                <?= __('Generating your virtual mirror image... Please wait, this can take up to 10 seconds...') ?>
            </div>
            <div class="error-message" style="display: none;">
                <?= __('Sorry, there was an error generating your image. Please try again.') ?>
            </div>
            <div class="virtual-mirror-image-container"></div>
        </div>
    </div>
    <script type="text/x-magento-init">
        {
            "#virtual-mirror-anchor": {
                "virtualMirrorProductAlert": {
                    "buttonSelector": "#call-mirror-method",
                    "generateImageEndpoint": "<?php echo $block->getImageGenerationEndpoint(); ?>",
                    "productId": "<?php echo $block->getProductId(); ?>"
                }
            }
        }
    </script>

<?php endif; ?>